(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{189:function(t,e,n){},190:function(t,e,n){"use strict";n.r(e);var i=n(3),o=n(4),a=n.n(o),s=n(48),r=n.n(s),l=(n(92),n(93),n(20)),c=n(21),h=n(14),d=n(27),u=n(26),g=n(15),v=(n(189),function(t){Object(d.a)(n,t);var e=Object(u.a)(n);function n(t){var i;return Object(l.a)(this,n),i=e.call(this,t),void 0!==t.parent&&t.parent.setChild(Object(h.a)(i)),i.state={editorState:g.EditorState.createWithText(t.defaultDialog)},i.focus=function(){return i.refs.editor.focus()},i.onChange=function(t){return i.setState({editorState:t})},i.handleKeyCommand=i._handleKeyCommand.bind(Object(h.a)(i)),i.mapKeyToEditorCommand=i._mapKeyToEditorCommand.bind(Object(h.a)(i)),i.toggleBlockType=i._toggleBlockType.bind(Object(h.a)(i)),i.toggleInlineStyle=i._toggleInlineStyle.bind(Object(h.a)(i)),i}return Object(c.a)(n,[{key:"_handleKeyCommand",value:function(t,e){var n=g.RichUtils.handleKeyCommand(e,t);return!!n&&(this.onChange(n),!0)}},{key:"_mapKeyToEditorCommand",value:function(t){if(9!==t.keyCode)return Object(g.getDefaultKeyBinding)(t);var e=g.RichUtils.onTab(t,this.state.editorState,4);e!==this.state.editorState&&this.onChange(e)}},{key:"_toggleBlockType",value:function(t){this.onChange(g.RichUtils.toggleBlockType(this.state.editorState,t))}},{key:"_toggleInlineStyle",value:function(t){this.onChange(g.RichUtils.toggleInlineStyle(this.state.editorState,t))}},{key:"render",value:function(){var t=this.state.editorState,e="RichEditor-editor",n=t.getCurrentContent();return n.hasText()||"unstyled"!==n.getBlockMap().first().getType()&&(e+=" RichEditor-hidePlaceholder"),Object(i.jsxs)("div",{className:"RichEditor-root",children:[Object(i.jsx)(b,{editorState:t,onToggle:this.toggleBlockType}),Object(i.jsx)(T,{editorState:t,onToggle:this.toggleInlineStyle}),Object(i.jsx)("div",{className:e,onClick:this.focus,children:Object(i.jsx)(g.Editor,{blockStyleFn:p,customStyleMap:m,editorState:t,handleKeyCommand:this.handleKeyCommand,keyBindingFn:this.mapKeyToEditorCommand,onChange:this.onChange,placeholder:"Tell a story...",ref:"editor",spellCheck:!0})})]})}}]),n}(a.a.Component)),m={CODE:{backgroundColor:"rgba(0, 0, 0, 0.05)",fontFamily:'"Inconsolata", "Menlo", "Consolas", monospace',fontSize:16,padding:2}};function p(t){switch(t.getType()){case"blockquote":return"RichEditor-blockquote";default:return null}}var f=function(t){Object(d.a)(n,t);var e=Object(u.a)(n);function n(){var t;return Object(l.a)(this,n),(t=e.call(this)).onToggle=function(e){e.preventDefault(),t.props.onToggle(t.props.style)},t}return Object(c.a)(n,[{key:"render",value:function(){var t="RichEditor-styleButton";return this.props.active&&(t+=" RichEditor-activeButton"),Object(i.jsx)("span",{className:t,onMouseDown:this.onToggle,children:this.props.label})}}]),n}(a.a.Component),y=[],b=function(t){var e=t.editorState,n=e.getSelection(),o=e.getCurrentContent().getBlockForKey(n.getStartKey()).getType();return Object(i.jsx)("div",{className:"RichEditor-controls",children:y.map((function(e){return Object(i.jsx)(f,{active:e.style===o,label:e.label,onToggle:t.onToggle,style:e.style},e.label)}))})},k=[],T=function(t){var e=t.editorState.getCurrentInlineStyle();return Object(i.jsx)("div",{className:"RichEditor-controls",children:k.map((function(n){return Object(i.jsx)(f,{active:e.has(n.style),label:n.label,onToggle:t.onToggle,style:n.style},n.label)}))})},E=v,j=n(2),I=n.n(j),O=function(){function t(e){Object(l.a)(this,t),this.EXIT="exit",this.DUNFORGET="save",this.REMEMBER="load",this.ADDTAG="addTag",this.VAR="var",this.ELSE="else",this.HASTAG="hasTag",this.UP="up",this.DELETETAG="deleteTag"}return Object(c.a)(t,[{key:"compile",value:function(t){this.code=t.split("\x01"),this.curLine=0,this.tags={},this.vars={},this.saves=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];for(var e=!1;this.curLine<this.code.length;++this.curLine){for(var n=0;n<this.code[this.curLine].length;++n)if("("===this.code[this.curLine][n]){e=!0;break}if(e)break}e?this.process(this.curLine):alert("You are missing the first left bracket! Code is incorrect.")}},{key:"executeAnOperation",value:function(t,e,n){var i=!1;switch(t){case this.VAR:var o=this.readFromPointToDot(this.code[n.line],e);e=o.charId,o=o.str;for(var a="",s=1;s<o.length-1;++s)a+=o[s];e=(o=this.readFromPointToDot(this.code[n.line],e)).charId,o=o.str;var r=this.readFromPointToDot(this.code[n.line],e);if(e=r.charId,r=parseInt(r.str),"="===o)this.vars[a]=r;else if("+="===o)this.vars[a]+=r;else{var l=!1;"=="===o?l=this.vars[a]===r:">="===o?l=this.vars[a]>=r:"!="===o?l=this.vars[a]!==r:"<="===o?l=this.vars[a]<=r:"<"===o?l=this.vars[a]<r:">"===o&&(l=this.vars[a]>r),l?n.maxIndentationLevel++:n.seekingForElse=-2}break;case this.ADDTAG:var c=this.readFromPointToDot(this.code[n.line],e);e=c.charId,c=c.str,this.tags[c]=!0;break;case this.DELETETAG:var h=this.readFromPointToDot(this.code[n.line],e);e=h.charId,h=h.str,this.tags[h]=!1;break;case this.HASTAG:var d=this.readFromPointToDot(this.code[n.line],e);e=d.charId,(d=d.str)in this.tags&&!1!==this.tags[d]?n.maxIndentationLevel++:n.seekingForElse=-2;break;case this.ELSE:n.seekingForElse>-1&&(n.seekingForElse=-1,n.maxIndentationLevel++);break;case this.EXIT:this.options=[],this.text="--EXITED THE DIALOG--",i=!0;break;case this.REMEMBER:var u=this.readFromPointToDot(this.code[n.line],e).str;this.process(this.saves[parseInt(u)]),i=!0;break;case this.DUNFORGET:var g=this.readFromPointToDot(this.code[n.line],e);e=g.charId,g=parseInt(g.str);var v=this.readFromPointToDot(this.code[n.line],e);e=v.charId,v=parseInt(v.str),this.saves[v]=g+1+n.line;break;case this.UP:var m=this.readFromPointToDot(this.code[n.line],e);e=m.charId,m=parseInt(m.str);var p=n.line-1;for(n.indentationLevel=-1;n.indentationLevel!==m;){for(var f=0;f<this.code[p].length;++f)if(" "!==this.code[p][f]&&"\t"!==this.code[p][f]&&"\n"!==this.code[p][f])if("("===this.code[p][f])n.indentationLevel++;else{if(")"!==this.code[p][f])break;n.indentationLevel--}p--}this.process(p+1),i=!0}return{needsToExit:i,charId:e}}},{key:"process",value:function(t){this.text="",this.options=[];var e={};for(e.line=++t,e.indentationLevel=1,e.minIndentationLevel=1,e.maxIndentationLevel=1,e.seekingForElse=-1;0!==e.indentationLevel;){e.seekingForElse>-1&&e.seekingForElse--;for(var n=0;n<this.code[e.line].length;){if("("===this.code[e.line][n])e.indentationLevel++;else if(")"===this.code[e.line][n])1!==e.maxIndentationLevel&&!1===(e.indentationLevel<e.minIndentationLevel||e.indentationLevel>e.maxIndentationLevel)?e.maxIndentationLevel--:-2===e.seekingForElse&&!0===(e.indentationLevel<e.minIndentationLevel||e.indentationLevel>e.maxIndentationLevel)&&(e.seekingForElse=2),e.indentationLevel--;else{if(e.indentationLevel<e.minIndentationLevel||e.indentationLevel>e.maxIndentationLevel){++n;continue}if("\\"===this.code[e.line][n]){for(var i="",o=++n;o<this.code[e.line].length&&"/"!==this.code[e.line][o];++o)i+=this.code[e.line][o];this.options.push([i,e.line+1]);break}if(":"===this.code[e.line][n]){n++;var a=this.readFromPointToDot(this.code[e.line],n);if(n=a.charId,'"'===(a=a.str)[0]){for(var s="",r=1;r<a.length-1;++r)s+=a[r];this.text=s}else{var l=this.executeAnOperation(a,n,e);if(1==l.needsToExit)return l.charId;n=l.charId}break}}++n}++e.line}}},{key:"getText",value:function(){return this.text}},{key:"getOptions",value:function(){return this.options}},{key:"chooseOption",value:function(t){this.curLine=t[1],this.process(this.curLine)}},{key:"readFromPointToDot",value:function(t,e){for(var n="",i=!1;e<t.length;){if('"'===t[e]&&(i=!i),i){if("\\"===t[e]&&t.length-1!==e&&"n"===t[e+1]){e+=2,n+="<br>";continue}}else if("."===t[e])return{str:n,charId:e+1};n+=t[e],++e}return{str:n,charId:e+1}}}]),t}(),C=function(t){Object(d.a)(n,t);var e=Object(u.a)(n);function n(t){var i;return Object(l.a)(this,n),(i=e.call(this,t)).defaultDialog=t.defaultDialog,i.state={editorState:I.a.createEmpty()},i.onChange=function(t){return i.setState({editorState:t})},i.dialogEngine=new O,i.previousOptions=[],i}return Object(c.a)(n,[{key:"setChild",value:function(t){this.editorComponentClass=t}},{key:"setupDraggableBar",value:function(){var t=document.querySelector(".RichEditor-root"),e=!1,n=document.querySelector(".dividerBar"),i=this,o=function(t){e=!e,i.editorContent.classList.toggle("prohibitSelection"),i.dialogOutputConent.classList.toggle("prohibitSelection")};n.addEventListener("mousedown",o,!1),n.addEventListener("mouseup",o,!1),document.addEventListener("mousemove",(function(n){e&&(t.style.width=(n.clientX-32).toString()+"px")}),!1)}},{key:"buttonClicked",value:function(){for(var t=this,e=0;e<this.previousOptions.length;++e)this.previousOptions[e].remove();this.previousOptions=[];var n=this.dialogEngine.getOptions();if(void 0!==n){for(var i=function(e){var i=document.createElement("button");i.innerHTML=n[e][0];var o=n[e],a=t;i.addEventListener("click",(function(){a.dialogEngine.chooseOption(o),a.buttonClicked()})),t.previousOptions.push(i),t.dialogOutputConent.appendChild(i)},o=0;o<n.length;++o)i(o);document.querySelector(".actualDialog").innerHTML=this.dialogEngine.getText()}}},{key:"componentDidMount",value:function(){var t=this;this.setupDraggableBar(),this.dialogOutputConent=document.querySelector(".dialogSide"),this.editorContent=document.querySelector(".public-DraftEditor-content");var e=this;document.querySelector(".compileButton").addEventListener("click",(function(){e.dialogEngine.compile(t.editorComponentClass.state.editorState.getCurrentContent().getPlainText("\x01")),e.buttonClicked()}))}},{key:"render",value:function(){return Object(i.jsx)(E,{parent:this,defaultDialog:this.defaultDialog})}}]),n}(a.a.Component);var L=function(){return Object(o.useEffect)((function(){document.title="Dialog Editor"}),[]),Object(i.jsx)("div",{className:"App",style:{height:"100%"},children:Object(i.jsxs)("div",{style:{height:"100%"},children:[Object(i.jsxs)("div",{className:"flexer",children:[Object(i.jsx)(C,{defaultDialog:x}),Object(i.jsx)("div",{className:"dividerBar"}),Object(i.jsx)("div",{className:"dialogSide",children:Object(i.jsx)("div",{className:"actualDialog",children:"Dialog will be visible here!"})})]}),Object(i.jsx)("button",{className:"compileButton",children:" Compile!"})]})})},x='\n\t//What you see now is an example dialog!\n\n(\n\n\t:"Good day, sir actor!"\n\t\\"Where am I?"/\n\t(\n\t\t:"I would say that you are in the theatre. You won\'t hear more from me."\n\t\t\\"..."/\n\t\t(\n\t\t\t:load.0\n\t\t)\n\t)\n\t\\"Who am I?"/\n\t(\n\t\t:"I already said that you, mister actor, are an actor. Why would you want to know more?"\n\t\t\\"..."/\n\t\t(\n\t\t\t:load.0\n\t\t)\n\t)\n\t\\"Who are you?"/\n\t(\n\t\t:"Wow, that\'s an interesting question... I\'m the owner of this theatre. My name will be a mystery for now."\n\t\t\\"..."/\n\t\t(\n\t\t\t:load.0\n\t\t)\n\t)\n\t\\"Where is the exit here?"/\n\t(\n\t\t:"There, first turn left."\n\t\t\\"Thanks, now I will go"/\n\t\t(\n\t\t\t:exit\n\t\t)\n\t\t\\"Alright, I\'ll remember that. You can continue now"/\n\t\t(\n\t\t\t:load.0\n\t\t)\n\t)\n\t:save.1.0\n\t\\"..."/\n\t(\n\t\t:"Who do you want to play? I see real talent in you."\n\t\t:var."jobs".=.0\n\t\t:hasTag."nonAustro"\n\t\t(\n\t\t\t:var."jobs".+=.1\n\t\t)\n\t\t:else\n\t\t(\n\t\t\\"I wouldn\'t mind being an astronaut"/\n\t\t(\n\t\t\t:"I\'m sorry but that role is already taken."\n\t\t\t\\"..."/\n\t\t\t(\n\t\t\t\t:addTag."nonAustro"\n\t\t\t\t:up.3\n\t\t\t)\n\t\t)\n\t\t)\n\t\t\n\t\t:hasTag."nonDragon"\n\t\t(\n\t\t\t:var."jobs".+=.1\n\t\t)\n\t\t:else\n\t\t(\n\t\t\\"Fantasy dragon please!"/\n\t\t(\n\t\t\t:"I\'m sorry but that role is already taken."\n\t\t\t\\"..."/\n\t\t\t(\n\t\t\t\t:addTag."nonDragon"\n\t\t\t\t:up.3\n\t\t\t)\n\t\t)\n\t\t)\n\t\t:hasTag."nonDetective"\n\t\t(\n\t\t\t:var."jobs".+=.1\n\t\t)\n\t\t:else\n\t\t(\n\t\t\\"I would like to play detective!"/\n\t\t(\n\t\t\t:"I\'m sorry but that role is already taken."\n\t\t\t\\"..."/\n\t\t\t(\n\t\t\t\t:addTag."nonDetective"\n\t\t\t\t:up.3\n\t\t\t)\n\t\t)\n\t\t)\n\t\t:var."jobs".==.3\n\t\t(\n\t\t\t\\"WHO CAN I EVEN PLAY!?"/\n\t\t\t(\n\t\t\t\t:"Hmmm... Let me check..."\n\t\t\t\t\t\\"..."/\n\t\t\t\t\t(\n\t\t\t\t\t\t:"Yes, I\'m very sorry... Apparently, only one role is vacant..."\n\t\t\t\t\t\t\\"Which one???"/\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\t:load.0\n\t\t\t\t\t\t)\n\t\t\t\t\t\t\\"Tell me!"/\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\t:load.0\n\t\t\t\t\t\t)\n\t\t\t\t\t\t:save.1.0\n\t\t\t\t\t\t\\"Speak!!!"/\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\t:"Yes... A simple man."\n\t\t\t\t\t\t\t\t\\"Huh?"/\n\t\t\t\t\t\t\t\t(\n\t\t\t//The game start here...\n\n:"You wake up in your bed and stare into the rotten ceiling."\n\\I want to sleep just a little bit more.../\n(\n\t:"Unfortunately, you still have to wake up."\n\t\\What a shame.../\n\t(\n\t\t:up.2\n\t)\n)\n\\"What time is it?"/\n(\n\t:" - you ask... You can\'t really hear an answer though."\n\t\\I will tell them.../\n\t(\n\t\t:up.2\n\t)\n)\n\\Time to rise from the bed.../\n(\n\t:exit\n)\n\t\t\t//The game ends here...\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t)\n\t\t\t)\n\t\t)\n\t)\n)';r.a.render(Object(i.jsx)(L,{}),document.getElementById("root"))},93:function(t,e,n){}},[[190,1,2]]]);
//# sourceMappingURL=main.e7f6cf93.chunk.js.map